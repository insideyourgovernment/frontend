"<html>\n<head>\n<meta name=\"description\" content=\"News and information about government agencies.\">  \n<script>\n  !function(g,s,q,r,d){r=g[r]=g[r]||function(){(r.q=r.q||[]).push(\n  arguments)};d=s.createElement(q);q=s.getElementsByTagName(q)[0];\n  d.src='//d1l6p2sc9645hc.cloudfront.net/tracker.js';q.parentNode.\n  insertBefore(d,q)}(window,document,'script','_gs');\n\n  _gs('GSN-445923-O');\n\n  // to track the current user in GoSquared People...\n  //_gs('identify', {\n  //  id:    1234,             // replace with the id of the current user\n  //  name:  'User Name',      // replace with the name of the current user\n  //  email: 'user@email.com', // replace with the email of the current user\n\n    // add any other properties...\n  //});\n</script><title>Inside Your Government: News and Information</title>\n<link href='https://fonts.googleapis.com/css?family=Oswald' rel='stylesheet' type='text/css'>\n<link href='https://fonts.googleapis.com/css?family=Merriweather:400,400italic,700' rel='stylesheet' type='text/css'>\n<style>\nhtml, body, div, span, applet, object, iframe,\nh1, h2, h3, h4, h5, h6, p, blockquote, pre,\na, abbr, acronym, address, big, cite, code,\ndel, dfn, em, img, ins, kbd, q, s, samp,\nsmall, strike, strong, sub, sup, tt, var,\nb, u, i, center,\ndl, dt, dd, ol, ul, li,\nfieldset, form, label, legend,\ntable, caption, tbody, tfoot, thead, tr, th, td,\narticle, aside, canvas, details, embed, \nfigure, figcaption, footer, header, hgroup, \nmenu, nav, output, ruby, section, summary,\ntime, mark, audio, video {\n\tmargin: 0;\n\tpadding: 0;\n\tborder: 0;\n\tfont-size: 100%;\n\tfont: inherit;\n\tvertical-align: baseline;\n}\n/* HTML5 display-role reset for older browsers */\narticle, aside, details, figcaption, figure, \nfooter, header, hgroup, menu, nav, section {\n\tdisplay: block;\n}\nbody {\n\tline-height: 1;\n}\nol, ul {\n\tlist-style: none;\n}\nblockquote, q {\n\tquotes: none;\n}\nblockquote:before, blockquote:after,\nq:before, q:after {\n\tcontent: '';\n\tcontent: none;\n}\ntable {\n\tborder-collapse: collapse;\n\tborder-spacing: 0;\n}\nstrong {\nfont-weight:bold;\n}\nbody {\nbackground:#FFF;\nline-height:1.5;\nfont-size:0.8em;\nfont-family: Arial, 'Merriweather', serif;\nmargin:0;\n}\n#header {\ndisplay:block;\ntext-decoration:none;\npadding:10px 20px;\nbackground:#000 url('/img/logo2.png') no-repeat 10px 10px;\nfont-family: 'Oswald', sans-serif;\ncolor:#fff;\n}\nh1 {\nmargin-right:20px;\npadding-left: 30px;\nfont-size:2em;\ndisplay:inline;\n}\n.tagline {\ncolor:#fff;\nfont-size:1.5em;\nfont-style:italic;\n}\n#intro {\nbackground:#fff600;\npadding:20px;\nfont-size:.95em;\nline-height:1.2;\n}\na:hover {\ntext-decoration:none;\n}\n    #nav {\nbackground:#fff;\nborder-bottom:1px solid #006;\ndisplay:block;\npadding:0 20px;\n}\n#nav a:link, #nav a:visited\n{\n//font-family: 'Oswald', sans-serif;\nfloat: left;\nfont-weight: bold;\ntext-decoration: none;\ncolor: #000;\npadding:9px 0 9px 0;\ndisplay:inline-block;\nmargin-right:20px;\n}\n.site_name {\n    //font-family: 'Oswald', sans-serif;\n    //font-weight:200  !important;\n    \n    }\n#allstars {\nmargin:0 0 20px 20px;\nfloat:right;\nwidth:300px;\nbackground:#fff600 url('/img/allstars2.png') no-repeat;\npadding:10px;\nborder-radius: 10px;\n}\n#allstars h3 {\npadding:0 50px;\ntext-align:center;\n}\n#allstars li {\nmargin-bottom:10px;\n}\n#main {\npadding:20px;\n}\n\n#nav a.current:link, #nav a.current:visited, #nav a:hover\n{\nborder-bottom: 4px solid #006;\npadding-bottom: 7px;\nbackground: transparent;\ncolor: #000;\n}\n\n.main, #working_space {\npadding:20px;\n}\nh2 {\nfont-size:1.5em;\n}\nh3 {\nfont-size:1.2em;\n}\nh2, h3 {\nfont-weight:bold;\n}\nh2, h3, table {\nmargin-bottom:10px;\n}\n.highlight {\nbackground:yellow;\n}\n</style>\n<script src=\"https://code.jquery.com/jquery-git2.min.js\"></script>\n<script>\n    function numberWithCommas(x) {\n    return x.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n}\n    function cell(value2, value3) {\n        table_html = '';\nif (!(value3 in value2)) {\n        table_html += '<td></td>';\n      } else if (value3.indexOf(\"photo\") > -1) {\n        table_html += '<td class=\"photo\"><img src=\"'+value2[value3]+'\" style=\"max-width:100px\" /></td>';\n      } else if (value2[value3] === parseInt(value2[value3], 10)) {\n        table_html += '<td>'+numberWithCommas(value2[value3])+'</td>';\n      } else if (value3 == 'links') {\n        table_html += '<td><ul>';\n        $.each(value2[value3], function(linki, link) {\n          table_html += '<li><a href=\"'+link['url']+'\">'+link['name']+'</a></li>';\n        });\n        table_html += '</ul></td>';\n      } else if (value3.indexOf('link') > -1) {\n        table_html += '<td><a href=\"'+value2[value3]+'\">'+value2[value3]+'</a></td>';\n      } else if (value3 == 'Summarized results') {\n        var sresults = value2[value3];\n        table_html += '<td><table>';\n        $.each(sresults, function(eindex, employee) {\n          table_html += '<tr><th colspan=\"2\">'+employee['heading']+'</th></tr>';\n          $.each(employee['allegations'], function(aindex, allegation) {\n            table_html += '<tr><th>'+allegation['heading']+'</th><td>'+allegation['allegation']+'</td></tr>';\n            if (stringStartsWith(allegation['opa_finding'], 'Sustained')) {\n              highlighting = ' class=\"highlight\"';\n            } else {\n              highlighting = '';\n            }\n            table_html += '<tr><th>'+allegation['heading']+' OPA finding</th><td'+highlighting+'>'+allegation['opa_finding']+'</td></tr>';\n          });\n          table_html += '<tr><th>Final discipline</th><td>'+employee['final_discipline']+'</td></tr>';\n        });\n        table_html += '</table>';\n        table_html += '</td>';\n      } else if (String(value2[value3]).indexOf('[object Object]') > -1 || Array.isArray(value2[value3])) {\n        if (typeof value2[value3].epoch_time != 'undefined') {\n          var date = new Date(value2[value3].epoch_time*1000);\n          table_html += '<td>'+date+'</td>';\n        } else {\n          table_html += '<td>'+JSON.stringify(value2[value3]).replace(/:\"/g, ': \"').replace(/,/g, ', ')+'</td>';\n        }\n      } else if (value3 in value2) {\n        table_html += '<td>'+value2[value3]+'</td>';\n      }\n        return table_html;\n    }\n    if(typeof console === \"undefined\"){\n    console = { log: function() { } };\n  }\n  function highlight(what, where) {\n    try {  \n    where.each(function() {\n      $(this).html($(this).html().replace(what.not('photo'), '<span class=\"highlight\">'+what+'</span>'));\n    });\n    } catch (err) {\n        \n    }\n  }\nfunction clone(obj) {\n    if (null == obj || \"object\" != typeof obj) return obj;\n    var copy = obj.constructor();\n    for (var attr in obj) {\n        if (obj.hasOwnProperty(attr)) copy[attr] = clone(obj[attr]);\n    }\n    return copy;\n}\nfunction stringStartsWith (string, prefix) {\n  return string.slice(0, prefix.length) == prefix;\n}\nfunction appendLater(what, when) {\n  setTimeout(function() {$('.data_results').append(what)}, when);   \n}\nfunction addData(table, element, data, page) {\n  element.html('');\n  window.payload = data['payload'];\n  //console.log(window.payload);  \n  //console.log('fields '+data['fields']);\n  var additional = '';\n  if ('has_string_in_any_field' in window.payload) {\n    additional = ' mentioning \"'+window.payload['has_string_in_any_field']+'\"';\n    setTimeout(function() {highlight(window.payload['has_string_in_any_field'], $('.data_results td'))}, 1500);\n  }\n  var title = data['table']['name']+additional;\n  var header = '<h2>'+title+'</h2>';\n  element.append(header);\n  header = '';\n  document.title = title + \" | Inside Your Government\";\n  header = '<a href=\"#!/data/?table='+data['table']['id']+'\">Link to table without any subqueries</a> ';\n  header += 'Raw data in JSON format at <span class=\"url\"></span>';\n  header += '<br/><strong>Search:</strong> <input type=\"text\" class=\"search_query\" /><input type=\"button\" data-table=\"'+data['table']['id']+'\" class=\"go\" value=\"go\" />';\n  if (data['number_of_rows'] == 1) {\n    header += ' ('+data['number_of_rows']+' row)';\n  } else {\n    header += ' ('+data['number_of_rows']+' '+data['name_for_rows']+')';\n  }\n  element.append(header);\n  header = '';\n  $.each(data['field_selectors'], function(i, value) {\n    if (value['selector'] == 'checkbox') {\n        var isboth = '';\n        var istrue = '';  \n        var isfalse = '';   \n        if ('filter' in window.payload) {\n          if (value['name'] in window.payload['filter']) {\n\n            switch(window.payload['filter'][value['name']]) {\n              case true:\n                  istrue = ' selected';\n                  break;\n              case false:\n                  isfalse = ' selected';\n                  break;\n            }        \n          }\n          else {\n            isboth = ' selected';\n          }\n        } else {\n          isboth = ' selected';\n        }\n\n        header += ' <select data-field=\"'+value['name']+'\" class=\"boolean_field\"><option value=\"both\"'+isboth+'>Both '+value['display_name']+' and Not '+value['display_name']+'</option><option value=\"true\"'+istrue+'>Only '+value['display_name']+'</option><option value=\"false\"'+isfalse+'>Only Not '+value['display_name']+'</option></select>';\n    } else if (value['selector'] == 'dropdown') {\n        header += ' <strong>'+value['display_name']+'</strong> <select data-field=\"'+value['name']+'\" class=\"dropdown_selector\">';\n        \n        selected = 'none';\n        if ('filter' in window.payload) {\n          if (value['name'] in window.payload['filter']) {\n            selected = window.payload[value['name']];\n          }\n        }\n        $.each(value['items'], function(items_i, item) {\n            if (item == selected) {\n                selected_html = ' selected';\n            } else {\n              selected_html = '';   \n            }\n            header += '<option value=\"'+item+'\"'+selected_html+'>'+item+'</option>';\n        });\n        if (selected == 'none') {\n            if ('none' == selected) {\n              selected_html = ' selected';\n            } else {\n              selected_html = '';   \n            }\n        }\n        header += '<option value=\"none\"'+selected_html+'></option>';\n        header += '</select>';\n    }\n  });\n  header += '<br/><strong>Sorting:</strong> ';\n  header += ' <strong>Field:</strong> ';\n  header += '<select class=\"field_for_sorting\">';\n  header += '<option value=\"\" selected></option>';\n  $.each(data['fields'], function(i, value) {\n    header += '<option value=\"'+value+'\">'+value+'</option>';\n  });\n  header += '</select>';\n  header += ' <strong>Direction:</strong> ';\n  header += '<select class=\"direction_for_sorting\">';\n  header += '<option value=\"desc\" selected>descending</option>';\n  header += '<option value=\"asc\">ascending</option>';   \n  header += '</select>';\n  if ('percentages' in data) {\n    if (data['percentages'].length > 0) {\n      header += '<h3>Auto generated analysis</h3>';\n      header += '<table class=\"data_table percentages\"><tr><th>Field</th><th>Value</th><th>Percentage</th><th>Sentence</th></tr>';\n      \n      $.each(data['percentages'], function(i, value) {\n        new_payload = clone(window.payload);\n        new_payload['filter'] = {};\n        new_payload['filter'][value['field']] = true;\n        header += '<tr><td>'+value['field']+'</td><td><a href=\"/#!/data/?payload='+encodeURIComponent(JSON.stringify(new_payload))+'\">'+value['value']+'</a></td><td>'+value['percentage']+'</td><td>'+value['sentence']+'</tr>';\n      });\n      header += '</table>';\n    }\n  }\n  element.append(header);\n  header = '';\n  header += '<h3>Rankings</h3>';\n  $.each(data['group_counts'], function(j, value2) {\n      header += '<table class=\"data_table\"><tr><th colspan=\"2\">'+value2[0]+'</th></tr>';\n      $.each(value2[1], function(h, value3) {\n          header += '<tr><td>'+JSON.stringify(value3[0])+'</td><td>'+value3[1]+'</td></tr>';\n      });\n      header += '</table>';\n  });\n  header += '<h3>The data</h3>';\n  header += '<div class=\"pages\"></div>';\n  element.append(header);\n  //header = '';\n  \n  var table_html = '<table class=\"data_table data_results\"></table><div class=\"pages\"></div>';\n  element.append(table_html);\n  table_html = '';\n  if (page * per_page < number_of_records) {\n      var rows = data['data'].slice((page-1) * per_page,page * per_page);\n  } else {\n      var rows = data['data'].slice((page-1) * per_page);\n  }\n  $.each(rows, function(j, value2) {\n    table_html += '<tr>';\n    \n    if ('default_fields_to_display' in data['table']) {\n      var fields = data['table']['default_fields_to_display'];\n    } else {\n      var fields = data['fields'];\n    }\n    $.each(fields, function(i, value) {\n      table_html += '<th>'+value+'</th>';\n    });\n    table_html += '</tr>';\n    table_html += '<tr>';\n    $.each(fields, function(h, value3) {\n      table_html += cell(value2, value3); \n    });\n    table_html += '</tr>';\n    //appendLater(table_html, j*5)\n    //$('.data_results').append(table_html);\n    //console.log(table_html);\n  });\n  \n  //table_html += '</table>';\n  setTimeout(function() {$('.data_results').html(table_html);}, 1000);\n    var number_of_records = data['number_of_rows'];\n    var per_page = 10\n    var pages = Math.floor(number_of_records / per_page);\n    if (pages > 1) {\n        if (number_of_records % per_page != 0) {\n            pages += 1;\n        }\n        if (pages+1 < 20) {\n          var end = pages + 1;\n        } else {\n          var end = 20;   \n        }\n        for (var i=1;i<end;i++) {\n            $('.pages').append('<a href=\"\" class=\"to_page_'+i+'\">'+i+'</a>');\n            //console.log(i+' '+pages);\n            if (i != pages) {\n              $('.pages').append(' | ');\n            }\n        }\n    }\n}\nfunction addUrl(element, url) {\n  window.location.hash = '!/data/'+url.substring(45);\n  //console.log('add url '+url);\n  setTimeout(function() {element.find('.url').html('<a href=\"'+url+'\">'+url+'</a>');}, 500);\n}\nfunction getData(table, element, other) {\n  element.text('Loading the data');\n  var params = {'table': table};\n  if (other) {\n    var params = other;\n    params['table'] = table;\n  }\n  $.ajax({\n      url: 'https://api.insideyourgovernment.com/retrive/',\n      data: {'payload': JSON.stringify(params)},\n      dataType: 'json',\n      complete : function(){\n        //console.log('url', this.url);\n          addUrl(element, this.url);\n      },\n      success: function(data){\n        window.data = data;\n        addData(table, element, window.data, 1);\n      }\n  });\n}\nfunction getDataForPayload(payload, element) {\n    element.text('Loading the data');\n  //console.log('type '+String(payload) == '[object Object]');\n  if (String(payload) == '[object Object]') {\n    $.ajax({\n        url: 'https://api.insideyourgovernment.com/retrive/',\n        data: {'payload': JSON.stringify(window.payload)},\n        dataType: 'json',\n        complete : function(){\n          //console.log('url', this.url);\n            addUrl(element, this.url);\n        },\n        success: function(data){\n          var table = data['table'];\n          window.data = data;\n          addData(table, element, data, 1);\n          if ('payload' in data) {\n            if ('has_string_in_any_field' in data['payload']) {\n              setTimeout(function() {$('.search_query').val(data['payload']['has_string_in_any_field'])}, 1000);\n            }\n          }\n        }\n    });\n    \n  } else {\n    \n    $.ajax({\n        url: 'https://api.insideyourgovernment.com/retrive/?payload='+payload,\n        \n        dataType: 'json',\n        complete : function(){\n          //console.log('url', this.url);\n            addUrl(element, this.url);\n        },\n        success: function(data){\n          window.data = data;\n          var table = data['table'];\n          addData(table, element, data, 1);\n          if ('payload' in data) {\n            if ('has_string_in_any_field' in data['payload']) {\n              setTimeout(function() {$('.search_query').val(data['payload']['has_string_in_any_field'])}, 500);\n            }\n          }\n        }\n    });\n  }\n}\nString.prototype.endsWith = function(suffix) {\n  return this.indexOf(suffix, this.length - suffix.length) !== -1;\n};\nfunction processHash() {\n  setTimeout(function() {\n    $('#share_buttons #facebook').html(\"<div class=\\\"fb-share-button\\\" data-href=\\\"\"+window.location+\" data-layout=\\\"button\\\"><\\/div>\");\n    $('#share_buttons #twitter').html(\"<a href=\\\"https:\\/\\/twitter.com\\/share\\\" class=\\\"twitter-share-button\\\"{count} data-size=\\\"large\\\">Tweet<\\/a>\\r\\n<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=\\/^http:\\/.test(d.location)?\\'http\\':\\'https\\';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+\\':\\/\\/platform.twitter.com\\/widgets.js\\';fjs.parentNode.insertBefore(js,fjs);}}(document, \\'script\\', \\'twitter-wjs\\');<\\/script>\");\n  }, 1000);\n  var hash = window.location.hash;\n  if (hash) {\n    if (hash.endsWith('/')) {\n      hash = hash.slice(3,-1);\n    } else {\n      hash = hash.slice(3);         \n    }\n    //console.log(hash);\n    $('.main').hide();\n    $('#nav a').removeClass('current');\n    $(\"[href='/#!/\"+hash+\"/']\").addClass('current');\n    //console.log('substring '+hash.substring(0, 11));\n    $('#working_space').text('');\n    if (hash.substring(0, 9) == 'articles/') {\n        //console.log('next substring '+hash.substring(9));\n        $('#'+hash.substring(9)+'_article').show();\n        document.title = $('#'+hash.substring(9)+'_article h2').text() + ' | Inside Your Government';\n        gaTrack(window.location.hash.substring(2), document.title + ' | Inside Your Government');\n        DISQUS.reset({\n          reload: true,\n          config: function () {  \n            this.page.identifier = hash.substring(9);  \n            this.page.url = window.location;\n          }\n        });\n    } else if (hash.substring(0, 12) == 'data/?table=') {\n        var table = hash.substring(12);\n        //console.log(table);\n        getData(table, $('#working_space'));\n        DISQUS.reset({\n          reload: true,\n          config: function () {  \n            this.page.identifier = hash.substring(9);  \n            this.page.url = window.location;\n          }\n        });\n    } else if (hash.substring(0, 14) == 'data/?payload=') {\n        var payload = hash.substring(14);\n        //console.log(table);\n        getDataForPayload(payload, $('#working_space'));\n        setTimeout(function() {DISQUS.reset({\n          reload: true,\n          config: function () {  \n            this.page.identifier = hash.substring(9);  \n            this.page.url = window.location;\n          }\n        })}, 1000);\n    } else {\n        \n        document.title = $('#'+hash+'_main h2').text() + ' | Inside Your Government';\n        gaTrack(window.location.hash.substring(2), document.title + ' | Inside Your Government');\n        $('#'+hash+'_main').show();\n        \n    }    \n    \n  } else {\n    window.location.hash = '#!/home/';\n    processHash();\n  }\n}\n\nfunction getCookie(cname) {\n    var name = cname + \"=\";\n    var ca = document.cookie.split(';');\n    for(var i=0; i<ca.length; i++) {\n        var c = ca[i];\n        while (c.charAt(0)==' ') c = c.substring(1);\n        if (c.indexOf(name) == 0) return c.substring(name.length,c.length);\n    }\n    return \"\";\n}\n\n// Function to load and initiate the Analytics tracker\nfunction gaTracker(id){\n  $.getScript('//www.google-analytics.com/analytics.js'); // jQuery shortcut\n  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;\n  ga('create', id, 'auto');\n  ga('send', 'pageview');\n}\n\n\n// Function to track a virtual page view\nfunction gaTrack(path, title) {\n  ga('set', { page: path, title: title });\n  ga('send', 'pageview');\n}\n\n\n$(function() {\n  $('#nav').height($('#nav a:link').outerHeight()+2);\n  gaTracker('UA-70789642-1');\n  $('#account_box').hide();\n  $('.main').not('#home').hide();\n  processHash();\n  //$('ul'+hash+':first').show();\n  $('body').on('click', 'a', function() {\n    //console.log($(this).attr('href').substring(0, 1));\n    if ($(this).attr('href').substring(0, 3) == \"/#!\" || $(this).attr('href').substring(0, 2) == \"#!\") {\n      setTimeout(function(){processHash();},100);\n    }\n  });\n  //console.log(document.cookie);\n  //console.log(getCookie('session'));\n  $.get('https://api.insideyourgovernment.com/get_session_info/', {'session': getCookie('session')}, function(data) {\n      //console.log(data);\n      $('#login_box').hide();\n      $('#account_box').show(); \n      if (data['is_admin']) {\n        $('.admin').show();\n        $.get('https://api.insideyourgovernment.com/tables/', function(data) {\n           $.each(data, function(i, value) {\n             $('#tables_for_action').append('<option value=\"'+value+'\">'+value+'</option>');\n           });           \n        });\n      }\n    }); \n  $('#login').click(function() {\n    $.post('https://api.insideyourgovernment.com/login/', {'email': $('#email').val(), 'password': $('#password').val()}, function(data) {\n        //console.log(typeof data);\n        //console.log(data['session_id']);\n      document.cookie=\"session=\"+data['session_id'];\n      //console.log(document.cookie);\n      //console.log(data);  \n    });  \n  });\n  $.fn.getAttributes = function() {\n    var attributes = {}; \n    if( this.length ) {\n        $.each( this[0].attributes, function( index, attr ) {\n            if (attr.name.substring(0,5) == 'data-') {\n              if (attr.name == 'data-pluck') {\n                attributes[ attr.name.slice(5) ] = JSON.parse(attr.value);\n              } else {\n                attributes[ attr.name.slice(5) ] = attr.value;\n              }\n            } else {\n              attributes[ attr.name ] = attr.value;\n            }\n        } ); \n    }\n    return attributes;\n  };\n  function addDivsOfTables(theObj, data) {\n    //theObj.html(JSON.stringify(data));\n    $.each(data['keys'], function(i, value) {\n      var table = '<table class=\"data_table\">';\n      table += '<tr><th>Link</th>';\n      $.each(data['table_fields'], function(j, value2) {\n        table += '<th>'+value2+'</th>';\n      });\n      //console.log(value+' '+JSON.stringify(data[value]));\n      $.each(data['data'][value], function(j, value2) {\n        table += '<tr>';\n        table += '<td><a href=\"/#!/data/?table='+value2[theObj.attr('data-field_for_url')]+'\">'+value2[theObj.attr('data-field_to_name_link')]+'</a>';\n        $.each(data['table_fields'], function(h, value3) {\n          table += cell(value2, value3);\n        });\n        table += '</tr>';\n      });\n      table += '</tr>';\n      table += '</table>';\n      theObj.append('<div class=\"box_200\"><h3>'+value+'</h3>'+table+'</div>');\n    });\n  }\n  function getDivsOfTables(theObj) {\n    var params = theObj.getAttributes();\n    //console.log('https://api.insideyourgovernment.com/retrive/?payload='+encodeURIComponent(JSON.stringify(params)))\n    $.get('https://api.insideyourgovernment.com/retrive/', {'payload': JSON.stringify(params)}, function(data) {\n      //console.log(data);\n        \n      addDivsOfTables(theObj, data);\n    });\n  }\n  $('.divs_of_tables').each(function() {\n    getDivsOfTables($(this));\n  });\n\n  $('body').on('click', '.go', function() {\n    var query = $(this).prev().val();\n    getData($(this).attr('data-table'), $('#working_space'), {'has_string_in_any_field': query});\n    setTimeout(function() {$('.search_query').val(query)}, 1000);\n    setTimeout(function() {highlight($('.search_query').val(), $('#working_space td').not('.photo'))}, 1000);\n  });\n  $(\"body\").on('keyup', '.search_query', function (e) {\n    if (e.keyCode == 13) {\n        $(this).parent().find('.go').trigger('click');\n    }\n  });\n  $('body').on('change', '.boolean_field', function(e) {\n    var f = $(this).attr('data-field');\n    window.payload['filter'] = {};\n    //console.log(JSON.stringify(window.payload));\n    if ($(this).val() == 'both') {\n      if ('filter' in window.payload) {\n        if ($(this).attr('data-field') in window.payload['filter']) {\n          delete window.payload['filter'][$(this).attr('data-field')];\n        }\n        if (Object.keys(window.payload['filter'])) {\n          delete window.payload['filter'];\n        }\n      }      \n    } else {\n      //console.log($(this).val(), Boolean($(this).val()));\n      window.payload['filter'][f] = ($(this).val() == 'true');\n    }\n    getDataForPayload(window.payload, $('#working_space'));\n    \n  });\n  $('body').on('change', '.dropdown_selector', function(e) {\n    var f = $(this).attr('data-field');\n    window.payload['filter'] = {};\n    //console.log(JSON.stringify(window.payload));\n    if ($(this).val() == 'none') {\n      if ('filter' in window.payload) {\n        if ($(this).attr('data-field') in window.payload['filter']) {\n          delete window.payload['filter'][$(this).attr('data-field')];\n        }\n        //if (Object.keys(window.payload['filter'])) {\n        //  delete window.payload['filter'];\n        //}\n      }      \n    } else {\n      //console.log($(this).val(), Boolean($(this).val()));\n      window.payload['filter'][f] = $(this).val();\n    }\n    getDataForPayload(window.payload, $('#working_space'));\n    \n  }); \n   $('body').on('click', '.pages a', function(e) {\n        e.preventDefault();\n        $('.pages a').removeClass('current');\n        $('.to_page_'+$(this).text()).addClass('current');\n        window['page'] = parseInt($(this).text());\n        getDataForPayload(window.data, $('#working_space'));\n        //addData(window.data['table']['id'], $('#working_space'), window.data, $(this).text());\n   });\n});\n</script>\n</head>\n<body>\n    <!--\n<a href=\"/#!/home/\" id=\"header\">\n<h1>Inside Your Government</h1>\n\n\n</a>\n    \n<div id=\"intro\">\n<strong>The mission:</strong> To make government transparent by default and to do as much <strong style=\"font-style:italic\">good</strong> with that transparency as possible.<br/>\n    <strong>Email:</strong> <a href=\"mailto:info@insideyourgovernment.com\">info@insideyourgovernment.com</a>\n    <strong>Twitter:</strong> <a href=\"https://twitter.com/insideyourgov\">@insideyourgov</a>\n    <strong>Facebook:</strong> <a href=\"https://www.facebook.com/insideyourgovernment/\">https://www.facebook.com/insideyourgovernment/</a>\n    <strong>Phone:</strong> (701) 404-7468\n\n</div>\n-->\n<ul id=\"nav\">\n    <li><a href=\"\" class=\"site_name\">Inside Your Government</a></li>\n    <!--\n<li><a href=\"/#!/about/\" data-id=\"about\">About Inside Your Government</a></li>-->\n<li><a href=\"/#!/data/\" data-id=\"data\">Open Data</a></li>\n\n<!--<li><a href=\"/#!/news/\" data-id=\"News\">News</a></li>\n<li><a href=\"/#!/get_involved/\" data-id=\"get_involved\">Get Involved</a></li>-->\n</ul>\n<p style=\"margin:20px 20px 0 20px;\"><strong>Attention:</strong> Inside Your Government (IYG) is a new web site aiming to be the most comprehensive free online source of news, searchable data, and apps about governments world wide. This site is in the early stages of being developed. Contact Tim Clemans at <a href=\"mailto:tim@insideyourgovernment.com\">tim@insideyourgovernment.com</a> for more information. Development activity log is at <a href=\"https://docs.google.com/spreadsheets/d/1qYpbFjDn3bmTEPjIlqaBEmduUea0-PLSBgQy9HqEsFw/edit#gid=0&vpid=A1\">https://docs.google.com/spreadsheets/d/1qYpbFjDn3bmTEPjIlqaBEmduUea0-PLSBgQy9HqEsFw/edit#gid=0&vpid=A1</a> The development focus is on the importing of data. The site is open source and its code is at <a href=\"https://github.com/insideyourgovernment/\">https://github.com/insideyourgovernment/</a></p>\n<div id=\"home_main\" class=\"main\">\n\n<div id=\"allstars\">\n<h3>Government Transparency All Stars</h3>\n<ul>\n<li><strong>New York City:</strong> By local law each city entity is to publish all of its digital public data by 2018. </li>\n<li><strong>Seattle Police Department:</strong> Posted on Youtube dash camera videos of three officer-involved shootings on the same day of the shootings.</li>\n\n<li><strong>King County Sheriff's Office:</strong> Released a spreadsheet of over 12 thousand employee actions including alleged misconduct with names in just 11 calendar days.</li>\n<li><strong>City of Redmond:</strong> Publishes money spent.</li>\n\n</ul>\n</div><h2>Home</h2>\n</div>\n<div class=\"main\" id=\"about_main\"><h2>About Inside Your Government</h2></div>\n<div class=\"main\" id=\"data_main\"><h2>Open Data</h2>\n\n<div id=\"data_admin\" class=\"admin\"><strong>Action:</strong> \n<select id=\"data_admin_action\">\n<option></option>\n<option value=\"table_create\">Table create</option>\n<option value=\"insert\">Insert</option>\n<option value=\"update\">Update</option>\n</select>\n<strong>Table name:</strong> <input type=\"text\" id=\"table_name_for_action\" /> \n<strong>Table:</strong> <select id=\"tables_for_action\">\n<option></option>\n</select>\n<strong>Dictionary:</strong> <input type=\"text\" id=\"dictionary_for_action\" />\n<input type=\"button\" value=\"Run\" />\n</div>\n\n<div class=\"divs_of_tables\" data-action=\"do_row_mapping\" data-table=\"tables\" data-field_for_key=\"categories\" data-field_for_url=\"id\" data-field_to_name_link=\"name\" data-rows_per_page=\"500\"></div>\n\n</div>\n<div class=\"main\" id=\"news_main\"><h2>News</h2></div>\n<div class=\"main\" id=\"get_involved_main\"><h2>Get Involved</h2></div>\n<div id=\"working_space\"></div>\n<script>\n/**\n* RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.\n* LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables\n*/\n/*\nvar disqus_config = function () {\nthis.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable\nthis.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable\n};\n*/\n(function() { // DON'T EDIT BELOW THIS LINE\nvar d = document, s = d.createElement('script');\n\ns.src = 'https://insideyourgovernment.disqus.com/embed.js';\n\ns.setAttribute('data-timestamp', +new Date());\n(d.head || d.body).appendChild(s);\n})();\n</script>\n<noscript>Please enable JavaScript to view the <a href=\"https://disqus.com/?ref_noscript\" rel=\"nofollow\">comments powered by Disqus.</a></noscript> \n<div id=\"disqus_thread\" style=\"width:50%; margin:10px 20px;\"></div>\n</div>\n</body>\n</html>\n"
{"patch":[[[[-1,"<html>\n<head>\n<meta name=\"description\" content=\"News and information about government agencies.\">  \n<script>\n  !function(g,s,q,r,d){r=g[r]=g[r]||function(){(r.q=r.q||[]).push(\n  arguments)};d=s.createElement(q);q=s.getElementsByTagName(q)[0];\n  d.src='//d1l6p2sc9645hc.cloudfront.net/tracker.js';q.parentNode.\n  insertBefore(d,q)}(window,document,'script','_gs');\n\n  _gs('GSN-445923-O');\n\n  // to track the current user in GoSquared People...\n  //_gs('identify', {\n  //  id:    1234,             // replace with the id of the current user\n  //  name:  'User Name',      // replace with the name of the current user\n  //  email: 'user@email.com', // replace with the email of the current user\n\n    // add any other properties...\n  //});\n</script><title>Inside Your Government: News and Information</title>\n<link href='https://fonts.googleapis.com/css?family=Oswald' rel='stylesheet' type='text/css'>\n<link href='https://fonts.googleapis.com/css?family=Merriweather:400,400italic,700' rel='stylesheet' type='text/css'>\n<style>\nhtml, body, div, span, applet, object, iframe,\nh1, h2, h3, h4, h5, h6, p, blockquote, pre,\na, abbr, acronym, address, big, cite, code,\ndel, dfn, em, img, ins, kbd, q, s, samp,\nsmall, strike, strong, sub, sup, tt, var,\nb, u, i, center,\ndl, dt, dd, ol, ul, li,\nfieldset, form, label, legend,\ntable, caption, tbody, tfoot, thead, tr, th, td,\narticle, aside, canvas, details, embed, \nfigure, figcaption, footer, header, hgroup, \nmenu, nav, output, ruby, section, summary,\ntime, mark, audio, video {\n\tmargin: 0;\n\tpadding: 0;\n\tborder: 0;\n\tfont-size: 100%;\n\tfont: inherit;\n\tvertical-align: baseline;\n}\n/* HTML5 display-role reset for older browsers */\narticle, aside, details, figcaption, figure, \nfooter, header, hgroup, menu, nav, section {\n\tdisplay: block;\n}\nbody {\n\tline-height: 1;\n}\nol, ul {\n\tlist-style: none;\n}\nblockquote, q {\n\tquotes: none;\n}\nblockquote:before, blockquote:after,\nq:before, q:after {\n\tcontent: '';\n\tcontent: none;\n}\ntable {\n\tborder-collapse: collapse;\n\tborder-spacing: 0;\n}\nstrong {\nfont-weight:bold;\n}\nbody {\nbackground:#FFF;\nline-height:1.5;\nfont-size:0.8em;\nfont-family: Arial, 'Merriweather', serif;\nmargin:0;\n}\n#header {\ndisplay:block;\ntext-decoration:none;\npadding:10px 20px;\nbackground:#000 url('/img/logo2.png') no-repeat 10px 10px;\nfont-family: 'Oswald', sans-serif;\ncolor:#fff;\n}\nh1 {\nmargin-right:20px;\npadding-left: 30px;\nfont-size:2em;\ndisplay:inline;\n}\n.tagline {\ncolor:#fff;\nfont-size:1.5em;\nfont-style:italic;\n}\n#intro {\nbackground:#fff600;\npadding:20px;\nfont-size:.95em;\nline-height:1.2;\n}\na:hover {\ntext-decoration:none;\n}\n    #nav {\nbackground:#fff;\nborder-bottom:1px solid #006;\ndisplay:block;\npadding:0 20px;\n}\n#nav a:link, #nav a:visited\n{\n//font-family: 'Oswald', sans-serif;\nfloat: left;\nfont-weight: bold;\ntext-decoration: none;\ncolor: #000;\npadding:9px 0 9px 0;\ndisplay:inline-block;\nmargin-right:20px;\n}\n.site_name {\n    //font-family: 'Oswald', sans-serif;\n    //font-weight:200  !important;\n    \n    }\n#allstars {\nmargin:0 0 20px 20px;\nfloat:right;\nwidth:300px;\nbackground:#fff600 url('/img/allstars2.png') no-repeat;\npadding:10px;\nborder-radius: 10px;\n}\n#allstars h3 {\npadding:0 50px;\ntext-align:center;\n}\n#allstars li {\nmargin-bottom:10px;\n}\n#main {\npadding:20px;\n}\n\n#nav a.current:link, #nav a.current:visited, #nav a:hover\n{\nborder-bottom: 4px solid #006;\npadding-bottom: 7px;\nbackground: transparent;\ncolor: #000;\n}\n\n.main, #working_space {\npadding:20px;\n}\nh2 {\nfont-size:1.5em;\n}\nh3 {\nfont-size:1.2em;\n}\nh2, h3 {\nfont-weight:bold;\n}\nh2, h3, table {\nmargin-bottom:10px;\n}\n.highlight {\nbackground:yellow;\n}\n</style>\n<script src=\"https://code.jquery.com/jquery-git2.min.js\"></script>\n<script>\n    function numberWithCommas(x) {\n    return x.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n}\n    function cell(value2, value3) {\n        table_html = '';\nif (!(value3 in value2)) {\n        table_html += '<td></td>';\n      } else if (value3.indexOf(\"photo\") > -1) {\n        table_html += '<td class=\"photo\"><img src=\"'+value2[value3]+'\" style=\"max-width:100px\" /></td>';\n      } else if (value2[value3] === parseInt(value2[value3], 10)) {\n        table_html += '<td>'+numberWithCommas(value2[value3])+'</td>';\n      } else if (value3 == 'links') {\n        table_html += '<td><ul>';\n        $.each(value2[value3], function(linki, link) {\n          table_html += '<li><a href=\"'+link['url']+'\">'+link['name']+'</a></li>';\n        });\n        table_html += '</ul></td>';\n      } else if (value3.indexOf('link') > -1) {\n        table_html += '<td><a href=\"'+value2[value3]+'\">'+value2[value3]+'</a></td>';\n      } else if (value3 == 'Summarized results') {\n        var sresults = value2[value3];\n        table_html += '<td><table>';\n        $.each(sresults, function(eindex, employee) {\n          table_html += '<tr><th colspan=\"2\">'+employee['heading']+'</th></tr>';\n          $.each(employee['allegations'], function(aindex, allegation) {\n            table_html += '<tr><th>'+allegation['heading']+'</th><td>'+allegation['allegation']+'</td></tr>';\n            if (stringStartsWith(allegation['opa_finding'], 'Sustained')) {\n              highlighting = ' class=\"highlight\"';\n            } else {\n              highlighting = '';\n            }\n            table_html += '<tr><th>'+allegation['heading']+' OPA finding</th><td'+highlighting+'>'+allegation['opa_finding']+'</td></tr>';\n          });\n          table_html += '<tr><th>Final discipline</th><td>'+employee['final_discipline']+'</td></tr>';\n        });\n        table_html += '</table>';\n        table_html += '</td>';\n      } else if (String(value2[value3]).indexOf('[object Object]') > -1 || Array.isArray(value2[value3])) {\n        if (typeof value2[value3].epoch_time != 'undefined') {\n          var date = new Date(value2[value3].epoch_time*1000);\n          table_html += '<td>'+date+'</td>';\n        } else {\n          table_html += '<td>'+JSON.stringify(value2[value3]).replace(/:\"/g, ': \"').replace(/,/g, ', ')+'</td>';\n        }\n      } else if (value3 in value2) {\n        table_html += '<td>'+value2[value3]+'</td>';\n      }\n        return table_html;\n    }\n    if(typeof console === \"undefined\"){\n    console = { log: function() { } };\n  }\n  function highlight(what, where) {\n    try {  \n    where.each(function() {\n      $(this).html($(this).html().replace(what.not('photo'), '<span class=\"highlight\">'+what+'</span>'));\n    });\n    } catch (err) {\n        \n    }\n  }\nfunction clone(obj) {\n    if (null == obj || \"object\" != typeof obj) return obj;\n    var copy = obj.constructor();\n    for (var attr in obj) {\n        if (obj.hasOwnProperty(attr)) copy[attr] = clone(obj[attr]);\n    }\n    return copy;\n}\nfunction stringStartsWith (string, prefix) {\n  return string.slice(0, prefix.length) == prefix;\n}\nfunction appendLater(what, when) {\n  setTimeout(function() {$('.data_results').append(what)}, when);   \n}\nfunction addData(table, element, data, page) {\n  element.html('');\n  window.payload = data['payload'];\n  //console.log(window.payload);  \n  //console.log('fields '+data['fields']);\n  var additional = '';\n  if ('has_string_in_any_field' in window.payload) {\n    additional = ' mentioning \"'+window.payload['has_string_in_any_field']+'\"';\n    setTimeout(function() {highlight(window.payload['has_string_in_any_field'], $('.data_results td'))}, 1500);\n  }\n  var title = data['table']['name']+additional;\n  var header = '<h2>'+title+'</h2>';\n  element.append(header);\n  header = '';\n  document.title = title + \" | Inside Your Government\";\n  header = '<a href=\"#!/data/?table='+data['table']['id']+'\">Link to table without any subqueries</a> ';\n  header += 'Raw data in JSON format at <span class=\"url\"></span>';\n  header += '<br/><strong>Search:</strong> <input type=\"text\" class=\"search_query\" /><input type=\"button\" data-table=\"'+data['table']['id']+'\" class=\"go\" value=\"go\" />';\n  if (data['number_of_rows'] == 1) {\n    header += ' ('+data['number_of_rows']+' row)';\n  } else {\n    header += ' ('+data['number_of_rows']+' '+data['name_for_rows']+')';\n  }\n  element.append(header);\n  header = '';\n  $.each(data['field_selectors'], function(i, value) {\n    if (value['selector'] == 'checkbox') {\n        var isboth = '';\n        var istrue = '';  \n        var isfalse = '';   \n        if ('filter' in window.payload) {\n          if (value['name'] in window.payload['filter']) {\n\n            switch(window.payload['filter'][value['name']]) {\n              case true:\n                  istrue = ' selected';\n                  break;\n              case false:\n                  isfalse = ' selected';\n                  break;\n            }        \n          }\n          else {\n            isboth = ' selected';\n          }\n        } else {\n          isboth = ' selected';\n        }\n\n        header += ' <select data-field=\"'+value['name']+'\" class=\"boolean_field\"><option value=\"both\"'+isboth+'>Both '+value['display_name']+' and Not '+value['display_name']+'</option><option value=\"true\"'+istrue+'>Only '+value['display_name']+'</option><option value=\"false\"'+isfalse+'>Only Not '+value['display_name']+'</option></select>';\n    } else if (value['selector'] == 'dropdown') {\n        header += ' <strong>'+value['display_name']+'</strong> <select data-field=\"'+value['name']+'\" class=\"dropdown_selector\">';\n        \n        selected = 'none';\n        if ('filter' in window.payload) {\n          if (value['name'] in window.payload['filter']) {\n            selected = window.payload[value['name']];\n          }\n        }\n        $.each(value['items'], function(items_i, item) {\n            if (item == selected) {\n                selected_html = ' selected';\n            } else {\n              selected_html = '';   \n            }\n            header += '<option value=\"'+item+'\"'+selected_html+'>'+item+'</option>';\n        });\n        if (selected == 'none') {\n            if ('none' == selected) {\n              selected_html = ' selected';\n            } else {\n              selected_html = '';   \n            }\n        }\n        header += '<option value=\"none\"'+selected_html+'></option>';\n        header += '</select>';\n    }\n  });\n  header += '<br/><strong>Sorting:</strong> ';\n  header += ' <strong>Field:</strong> ';\n  header += '<select class=\"field_for_sorting\">';\n  header += '<option value=\"\" selected></option>';\n  $.each(data['fields'], function(i, value) {\n    header += '<option value=\"'+value+'\">'+value+'</option>';\n  });\n  header += '</select>';\n  header += ' <strong>Direction:</strong> ';\n  header += '<select class=\"direction_for_sorting\">';\n  header += '<option value=\"desc\" selected>descending</option>';\n  header += '<option value=\"asc\">ascending</option>';   \n  header += '</select>';\n  if ('percentages' in data) {\n    if (data['percentages'].length > 0) {\n      header += '<h3>Auto generated analysis</h3>';\n      header += '<table class=\"data_table percentages\"><tr><th>Field</th><th>Value</th><th>Percentage</th><th>Sentence</th></tr>';\n      \n      $.each(data['percentages'], function(i, value) {\n        new_payload = clone(window.payload);\n        new_payload['filter'] = {};\n        new_payload['filter'][value['field']] = true;\n        header += '<tr><td>'+value['field']+'</td><td><a href=\"/#!/data/?payload='+encodeURIComponent(JSON.stringify(new_payload))+'\">'+value['value']+'</a></td><td>'+value['percentage']+'</td><td>'+value['sentence']+'</tr>';\n      });\n      header += '</table>';\n    }\n  }\n  element.append(header);\n  header = '';\n  header += '<h3>Rankings</h3>';\n  $.each(data['group_counts'], function(j, value2) {\n      header += '<table class=\"data_table\"><tr><th colspan=\"2\">'+value2[0]+'</th></tr>';\n      $.each(value2[1], function(h, value3) {\n          header += '<tr><td>'+JSON.stringify(value3[0])+'</td><td>'+value3[1]+'</td></tr>';\n      });\n      header += '</table>';\n  });\n  header += '<h3>The data</h3>';\n  header += '<div class=\"pages\"></div>';\n  element.append(header);\n  //header = '';\n  \n  var table_html = '<table class=\"data_table data_results\"></table><div class=\"pages\"></div>';\n  element.append(table_html);\n  table_html = '';\n  if (page * per_page < number_of_records) {\n      var rows = data['data'].slice((page-1) * per_page,page * per_page);\n  } else {\n      var rows = data['data'].slice((page-1) * per_page);\n  }\n  $.each(rows, function(j, value2) {\n    table_html += '<tr>';\n    \n    if ('default_fields_to_display' in data['table']) {\n      var fields = data['table']['default_fields_to_display'];\n    } else {\n      var fields = data['fields'];\n    }\n    $.each(fields, function(i, value) {\n      table_html += '<th>'+value+'</th>';\n    });\n    table_html += '</tr>';\n    table_html += '<tr>';\n    $.each(fields, function(h, value3) {\n      table_html += cell(value2, value3); \n    });\n    table_html += '</tr>';\n    //appendLater(table_html, j*5)\n    //$('.data_results').append(table_html);\n    //console.log(table_html);\n  });\n  \n  //table_html += '</table>';\n  setTimeout(function() {$('.data_results').html(table_html);}, 1000);\n    var number_of_records = data['number_of_rows'];\n    var per_page = 10\n    var pages = Math.floor(number_of_records / per_page);\n    if (pages > 1) {\n        if (number_of_records % per_page != 0) {\n            pages += 1;\n        }\n        if (pages+1 < 20) {\n          var end = pages + 1;\n        } else {\n          var end = 20;   \n        }\n        for (var i=1;i<end;i++) {\n            $('.pages').append('<a href=\"\" class=\"to_page_'+i+'\">'+i+'</a>');\n            //console.log(i+' '+pages);\n            if (i != pages) {\n              $('.pages').append(' | ');\n            }\n        }\n    }\n}\nfunction addUrl(element, url) {\n  window.location.hash = '!/data/'+url.substring(45);\n  //console.log('add url '+url);\n  setTimeout(function() {element.find('.url').html('<a href=\"'+url+'\">'+url+'</a>');}, 500);\n}\nfunction getData(table, element, other) {\n  element.text('Loading the data');\n  var params = {'table': table};\n  if (other) {\n    var params = other;\n    params['table'] = table;\n  }\n  $.ajax({\n      url: 'https://api.insideyourgovernment.com/retrive/',\n      data: {'payload': JSON.stringify(params)},\n      dataType: 'json',\n      complete : function(){\n        //console.log('url', this.url);\n          addUrl(element, this.url);\n      },\n      success: function(data){\n        window.data = data;\n        addData(table, element, window.data, 1);\n      }\n  });\n}\nfunction getDataForPayload(payload, element) {\n    element.text('Loading the data');\n  //console.log('type '+String(payload) == '[object Object]');\n  if (String(payload) == '[object Object]') {\n    $.ajax({\n        url: 'https://api.insideyourgovernment.com/retrive/',\n        data: {'payload': JSON.stringify(window.payload)},\n        dataType: 'json',\n        complete : function(){\n          //console.log('url', this.url);\n            addUrl(element, this.url);\n        },\n        success: function(data){\n          var table = data['table'];\n          window.data = data;\n          addData(table, element, data, 1);\n          if ('payload' in data) {\n            if ('has_string_in_any_field' in data['payload']) {\n              setTimeout(function() {$('.search_query').val(data['payload']['has_string_in_any_field'])}, 1000);\n            }\n          }\n        }\n    });\n    \n  } else {\n    \n    $.ajax({\n        url: 'https://api.insideyourgovernment.com/retrive/?payload='+payload,\n        \n        dataType: 'json',\n        complete : function(){\n          //console.log('url', this.url);\n            addUrl(element, this.url);\n        },\n        success: function(data){\n          window.data = data;\n          var table = data['table'];\n          addData(table, element, data, 1);\n          if ('payload' in data) {\n            if ('has_string_in_any_field' in data['payload']) {\n              setTimeout(function() {$('.search_query').val(data['payload']['has_string_in_any_field'])}, 500);\n            }\n          }\n        }\n    });\n  }\n}\nString.prototype.endsWith = function(suffix) {\n  return this.indexOf(suffix, this.length - suffix.length) !== -1;\n};\nfunction processHash() {\n  setTimeout(function() {\n    $('#share_buttons #facebook').html(\"<div class=\\\"fb-share-button\\\" data-href=\\\"\"+window.location+\" data-layout=\\\"button\\\"><\\/div>\");\n    $('#share_buttons #twitter').html(\"<a href=\\\"https:\\/\\/twitter.com\\/share\\\" class=\\\"twitter-share-button\\\"{count} data-size=\\\"large\\\">Tweet<\\/a>\\r\\n<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=\\/^http:\\/.test(d.location)?\\'http\\':\\'https\\';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+\\':\\/\\/platform.twitter.com\\/widgets.js\\';fjs.parentNode.insertBefore(js,fjs);}}(document, \\'script\\', \\'twitter-wjs\\');<\\/script>\");\n  }, 1000);\n  var hash = window.location.hash;\n  if (hash) {\n    if (hash.endsWith('/')) {\n      hash = hash.slice(3,-1);\n    } else {\n      hash = hash.slice(3);         \n    }\n    //console.log(hash);\n    $('.main').hide();\n    $('#nav a').removeClass('current');\n    $(\"[href='/#!/\"+hash+\"/']\").addClass('current');\n    //console.log('substring '+hash.substring(0, 11));\n    $('#working_space').text('');\n    if (hash.substring(0, 9) == 'articles/') {\n        //console.log('next substring '+hash.substring(9));\n        $('#'+hash.substring(9)+'_article').show();\n        document.title = $('#'+hash.substring(9)+'_article h2').text() + ' | Inside Your Government';\n        gaTrack(window.location.hash.substring(2), document.title + ' | Inside Your Government');\n        DISQUS.reset({\n          reload: true,\n          config: function () {  \n            this.page.identifier = hash.substring(9);  \n            this.page.url = window.location;\n          }\n        });\n    } else if (hash.substring(0, 12) == 'data/?table=') {\n        var table = hash.substring(12);\n        //console.log(table);\n        getData(table, $('#working_space'));\n        DISQUS.reset({\n          reload: true,\n          config: function () {  \n            this.page.identifier = hash.substring(9);  \n            this.page.url = window.location;\n          }\n        });\n    } else if (hash.substring(0, 14) == 'data/?payload=') {\n        var payload = hash.substring(14);\n        //console.log(table);\n        getDataForPayload(payload, $('#working_space'));\n        setTimeout(function() {DISQUS.reset({\n          reload: true,\n          config: function () {  \n            this.page.identifier = hash.substring(9);  \n            this.page.url = window.location;\n          }\n        })}, 1000);\n    } else {\n        \n        document.title = $('#'+hash+'_main h2').text() + ' | Inside Your Government';\n        gaTrack(window.location.hash.substring(2), document.title + ' | Inside Your Government');\n        $('#'+hash+'_main').show();\n        \n    }    \n    \n  } else {\n    window.location.hash = '#!/home/';\n    processHash();\n  }\n}\n\nfunction getCookie(cname) {\n    var name = cname + \"=\";\n    var ca = document.cookie.split(';');\n    for(var i=0; i<ca.length; i++) {\n        var c = ca[i];\n        while (c.charAt(0)==' ') c = c.substring(1);\n        if (c.indexOf(name) == 0) return c.substring(name.length,c.length);\n    }\n    return \"\";\n}\n\n// Function to load and initiate the Analytics tracker\nfunction gaTracker(id){\n  $.getScript('//www.google-analytics.com/analytics.js'); // jQuery shortcut\n  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;\n  ga('create', id, 'auto');\n  ga('send', 'pageview');\n}\n\n\n// Function to track a virtual page view\nfunction gaTrack(path, title) {\n  ga('set', { page: path, title: title });\n  ga('send', 'pageview');\n}\n\n\n$(function() {\n  $('#nav').height($('#nav a:link').outerHeight()+2);\n  gaTracker('UA-70789642-1');\n  $('#account_box').hide();\n  $('.main').not('#home').hide();\n  processHash();\n  //$('ul'+hash+':first').show();\n  $('body').on('click', 'a', function() {\n    //console.log($(this).attr('href').substring(0, 1));\n    if ($(this).attr('href').substring(0, 3) == \"/#!\" || $(this).attr('href').substring(0, 2) == \"#!\") {\n      setTimeout(function(){processHash();},100);\n    }\n  });\n  //console.log(document.cookie);\n  //console.log(getCookie('session'));\n  $.get('https://api.insideyourgovernment.com/get_session_info/', {'session': getCookie('session')}, function(data) {\n      //console.log(data);\n      $('#login_box').hide();\n      $('#account_box').show(); \n      if (data['is_admin']) {\n        $('.admin').show();\n        $.get('https://api.insideyourgovernment.com/tables/', function(data) {\n           $.each(data, function(i, value) {\n             $('#tables_for_action').append('<option value=\"'+value+'\">'+value+'</option>');\n           });           \n        });\n      }\n    }); \n  $('#login').click(function() {\n    $.post('https://api.insideyourgovernment.com/login/', {'email': $('#email').val(), 'password': $('#password').val()}, function(data) {\n        //console.log(typeof data);\n        //console.log(data['session_id']);\n      document.cookie=\"session=\"+data['session_id'];\n      //console.log(document.cookie);\n      //console.log(data);  \n    });  \n  });\n  $.fn.getAttributes = function() {\n    var attributes = {}; \n    if( this.length ) {\n        $.each( this[0].attributes, function( index, attr ) {\n            if (attr.name.substring(0,5) == 'data-') {\n              if (attr.name == 'data-pluck') {\n                attributes[ attr.name.slice(5) ] = JSON.parse(attr.value);\n              } else {\n                attributes[ attr.name.slice(5) ] = attr.value;\n              }\n            } else {\n              attributes[ attr.name ] = attr.value;\n            }\n        } ); \n    }\n    return attributes;\n  };\n  function addDivsOfTables(theObj, data) {\n    //theObj.html(JSON.stringify(data));\n    $.each(data['keys'], function(i, value) {\n      var table = '<table class=\"data_table\">';\n      table += '<tr><th>Link</th>';\n      $.each(data['table_fields'], function(j, value2) {\n        table += '<th>'+value2+'</th>';\n      });\n      //console.log(value+' '+JSON.stringify(data[value]));\n      $.each(data['data'][value], function(j, value2) {\n        table += '<tr>';\n        table += '<td><a href=\"/#!/data/?table='+value2[theObj.attr('data-field_for_url')]+'\">'+value2[theObj.attr('data-field_to_name_link')]+'</a>';\n        $.each(data['table_fields'], function(h, value3) {\n          table += cell(value2, value3);\n        });\n        table += '</tr>';\n      });\n      table += '</tr>';\n      table += '</table>';\n      theObj.append('<div class=\"box_200\"><h3>'+value+'</h3>'+table+'</div>');\n    });\n  }\n  function getDivsOfTables(theObj) {\n    var params = theObj.getAttributes();\n    //console.log('https://api.insideyourgovernment.com/retrive/?payload='+encodeURIComponent(JSON.stringify(params)))\n    $.get('https://api.insideyourgovernment.com/retrive/', {'payload': JSON.stringify(params)}, function(data) {\n      //console.log(data);\n        \n      addDivsOfTables(theObj, data);\n    });\n  }\n  $('.divs_of_tables').each(function() {\n    getDivsOfTables($(this));\n  });\n\n  $('body').on('click', '.go', function() {\n    var query = $(this).prev().val();\n    getData($(this).attr('data-table'), $('#working_space'), {'has_string_in_any_field': query});\n    setTimeout(function() {$('.search_query').val(query)}, 1000);\n    setTimeout(function() {highlight($('.search_query').val(), $('#working_space td').not('.photo'))}, 1000);\n  });\n  $(\"body\").on('keyup', '.search_query', function (e) {\n    if (e.keyCode == 13) {\n        $(this).parent().find('.go').trigger('click');\n    }\n  });\n  $('body').on('change', '.boolean_field', function(e) {\n    var f = $(this).attr('data-field');\n    window.payload['filter'] = {};\n    //console.log(JSON.stringify(window.payload));\n    if ($(this).val() == 'both') {\n      if ('filter' in window.payload) {\n        if ($(this).attr('data-field') in window.payload['filter']) {\n          delete window.payload['filter'][$(this).attr('data-field')];\n        }\n        if (Object.keys(window.payload['filter'])) {\n          delete window.payload['filter'];\n        }\n      }      \n    } else {\n      //console.log($(this).val(), Boolean($(this).val()));\n      window.payload['filter'][f] = ($(this).val() == 'true');\n    }\n    getDataForPayload(window.payload, $('#working_space'));\n    \n  });\n  $('body').on('change', '.dropdown_selector', function(e) {\n    var f = $(this).attr('data-field');\n    window.payload['filter'] = {};\n    //console.log(JSON.stringify(window.payload));\n    if ($(this).val() == 'none') {\n      if ('filter' in window.payload) {\n        if ($(this).attr('data-field') in window.payload['filter']) {\n          delete window.payload['filter'][$(this).attr('data-field')];\n        }\n        //if (Object.keys(window.payload['filter'])) {\n        //  delete window.payload['filter'];\n        //}\n      }      \n    } else {\n      //console.log($(this).val(), Boolean($(this).val()));\n      window.payload['filter'][f] = $(this).val();\n    }\n    getDataForPayload(window.payload, $('#working_space'));\n    \n  }); \n   $('body').on('click', '.pages a', function(e) {\n        e.preventDefault();\n        $('.pages a').removeClass('current');\n        $('.to_page_'+$(this).text()).addClass('current');\n        window['page'] = parseInt($(this).text());\n        getDataForPayload(window.data, $('#working_space'));\n        //addData(window.data['table']['id'], $('#working_space'), window.data, $(this).text());\n   });\n});\n</script>\n</head>\n<body>\n    <!--\n<a href=\"/#!/home/\" id=\"header\">\n<h1>Inside Your Government</h1>\n\n\n</a>\n    \n<div id=\"intro\">\n<strong>The mission:</strong> To make government transparent by default and to do as much <strong style=\"font-style:italic\">good</strong> with that transparency as possible.<br/>\n    <strong>Email:</strong> <a href=\"mailto:info@insideyourgovernment.com\">info@insideyourgovernment.com</a>\n    <strong>Twitter:</strong> <a href=\"https://twitter.com/insideyourgov\">@insideyourgov</a>\n    <strong>Facebook:</strong> <a href=\"https://www.facebook.com/insideyourgovernment/\">https://www.facebook.com/insideyourgovernment/</a>\n    <strong>Phone:</strong> (701) 404-7468\n\n</div>\n-->\n<ul id=\"nav\">\n    <li><a href=\"\" class=\"site_name\">Inside Your Government</a></li>\n    <!--\n<li><a href=\"/#!/about/\" data-id=\"about\">About Inside Your Government</a></li>-->\n<li><a href=\"/#!/data/\" data-id=\"data\">Open Data</a></li>\n\n<!--<li><a href=\"/#!/news/\" data-id=\"News\">News</a></li>\n<li><a href=\"/#!/get_involved/\" data-id=\"get_involved\">Get Involved</a></li>-->\n</ul>\n<p style=\"margin:20px 20px 0 20px;\"><strong>Attention:</strong> Inside Your Government (IYG) is a new web site aiming to be the most comprehensive free online source of news, searchable data, and apps about governments world wide. This site is in the early stages of being developed. Contact Tim Clemans at <a href=\"mailto:tim@insideyourgovernment.com\">tim@insideyourgovernment.com</a> for more information. Development activity log is at <a href=\"https://docs.google.com/spreadsheets/d/1qYpbFjDn3bmTEPjIlqaBEmduUea0-PLSBgQy9HqEsFw/edit#gid=0&vpid=A1\">https://docs.google.com/spreadsheets/d/1qYpbFjDn3bmTEPjIlqaBEmduUea0-PLSBgQy9HqEsFw/edit#gid=0&vpid=A1</a> The development focus is on the importing of data. The site is open source and its code is at <a href=\"https://github.com/insideyourgovernment/\">https://github.com/insideyourgovernment/</a></p>\n<div id=\"home_main\" class=\"main\">\n\n<div id=\"allstars\">\n<h3>Government Transparency All Stars</h3>\n<ul>\n<li><strong>New York City:</strong> By local law each city entity is to publish all of its digital public data by 2018. </li>\n<li><strong>Seattle Police Department:</strong> Posted on Youtube dash camera videos of three officer-involved shootings on the same day of the shootings.</li>\n\n<li><strong>King County Sheriff's Office:</strong> Released a spreadsheet of over 12 thousand employee actions including alleged misconduct with names in just 11 calendar days.</li>\n<li><strong>City of Redmond:</strong> Publishes money spent.</li>\n\n</ul>\n</div><h2>Home</h2>\n</div>\n<div class=\"main\" id=\"about_main\"><h2>About Inside Your Government</h2></div>\n<div class=\"main\" id=\"data_main\"><h2>Open Data</h2>\n\n<div id=\"data_admin\" class=\"admin\"><strong>Action:</strong> \n<select id=\"data_admin_action\">\n<option></option>\n<option value=\"table_create\">Table create</option>\n<option value=\"insert\">Insert</option>\n<option value=\"update\">Update</option>\n</select>\n<strong>Table name:</strong> <input type=\"text\" id=\"table_name_for_action\" /> \n<strong>Table:</strong> <select id=\"tables_for_action\">\n<option></option>\n</select>\n<strong>Dictionary:</strong> <input type=\"text\" id=\"dictionary_for_action\" />\n<input type=\"button\" value=\"Run\" />\n</div>\n\n<div class=\"divs_of_tables\" data-action=\"do_row_mapping\" data-table=\"tables\" data-field_for_key=\"categories\" data-field_for_url=\"id\" data-field_to_name_link=\"name\" data-rows_per_page=\"500\"></div>\n\n</div>\n<div class=\"main\" id=\"news_main\"><h2>News</h2></div>\n<div class=\"main\" id=\"get_involved_main\"><h2>Get Involved</h2></div>\n<div id=\"working_space\"></div>\n<script>\n/**\n* RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.\n* LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables\n*/\n/*\nvar disqus_config = function () {\nthis.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable\nthis.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable\n};\n*/\n(function() { // DON'T EDIT BELOW THIS LINE\nvar d = document, s = d.createElement('script');\n\ns.src = 'https://insideyourgovernment.disqus.com/embed.js';\n\ns.setAttribute('data-timestamp', +new Date());\n(d.head || d.body).appendChild(s);\n})();\n</script>\n<noscript>Please enable JavaScript to view the <a href=\"https://disqus.com/?ref_noscript\" rel=\"nofollow\">comments powered by Disqus.</a></noscript> \n<div id=\"disqus_thread\" style=\"width:50%; margin:10px 20px;\"></div>\n</div>\n</body>\n</html>\n"],[1,"a"]],0,0,29975,1]],"time":1450809544170}
{"patch":[[[[-1,"a"],[1,"<html>\n<head>\n<meta name=\"description\" content=\"News and information about government agencies.\">  \n<script>\n  !function(g,s,q,r,d){r=g[r]=g[r]||function(){(r.q=r.q||[]).push(\n  arguments)};d=s.createElement(q);q=s.getElementsByTagName(q)[0];\n  d.src='//d1l6p2sc9645hc.cloudfront.net/tracker.js';q.parentNode.\n  insertBefore(d,q)}(window,document,'script','_gs');\n\n  _gs('GSN-445923-O');\n\n  // to track the current user in GoSquared People...\n  //_gs('identify', {\n  //  id:    1234,             // replace with the id of the current user\n  //  name:  'User Name',      // replace with the name of the current user\n  //  email: 'user@email.com', // replace with the email of the current user\n\n    // add any other properties...\n  //});\n</script><title>Inside Your Government: News and Information</title>\n<link href='https://fonts.googleapis.com/css?family=Oswald' rel='stylesheet' type='text/css'>\n<link href='https://fonts.googleapis.com/css?family=Merriweather:400,400italic,700' rel='stylesheet' type='text/css'>\n<style>\nhtml, body, div, span, applet, object, iframe,\nh1, h2, h3, h4, h5, h6, p, blockquote, pre,\na, abbr, acronym, address, big, cite, code,\ndel, dfn, em, img, ins, kbd, q, s, samp,\nsmall, strike, strong, sub, sup, tt, var,\nb, u, i, center,\ndl, dt, dd, ol, ul, li,\nfieldset, form, label, legend,\ntable, caption, tbody, tfoot, thead, tr, th, td,\narticle, aside, canvas, details, embed, \nfigure, figcaption, footer, header, hgroup, \nmenu, nav, output, ruby, section, summary,\ntime, mark, audio, video {\n\tmargin: 0;\n\tpadding: 0;\n\tborder: 0;\n\tfont-size: 100%;\n\tfont: inherit;\n\tvertical-align: baseline;\n}\n/* HTML5 display-role reset for older browsers */\narticle, aside, details, figcaption, figure, \nfooter, header, hgroup, menu, nav, section {\n\tdisplay: block;\n}\nbody {\n\tline-height: 1;\n}\nol, ul {\n\tlist-style: none;\n}\nblockquote, q {\n\tquotes: none;\n}\nblockquote:before, blockquote:after,\nq:before, q:after {\n\tcontent: '';\n\tcontent: none;\n}\ntable {\n\tborder-collapse: collapse;\n\tborder-spacing: 0;\n}\nstrong {\nfont-weight:bold;\n}\nbody {\nbackground:#FFF;\nline-height:1.5;\nfont-size:0.8em;\nfont-family: Arial, 'Merriweather', serif;\nmargin:0;\n}\n#header {\ndisplay:block;\ntext-decoration:none;\npadding:10px 20px;\nbackground:#000 url('/img/logo2.png') no-repeat 10px 10px;\nfont-family: 'Oswald', sans-serif;\ncolor:#fff;\n}\nh1 {\nmargin-right:20px;\npadding-left: 30px;\nfont-size:2em;\ndisplay:inline;\n}\n.tagline {\ncolor:#fff;\nfont-size:1.5em;\nfont-style:italic;\n}\n#intro {\nbackground:#fff600;\npadding:20px;\nfont-size:.95em;\nline-height:1.2;\n}\na:hover {\ntext-decoration:none;\n}\n    #nav {\nbackground:#fff;\nborder-bottom:1px solid #006;\ndisplay:block;\npadding:0 20px;\n}\n#nav a:link, #nav a:visited\n{\n//font-family: 'Oswald', sans-serif;\nfloat: left;\nfont-weight: bold;\ntext-decoration: none;\ncolor: #000;\npadding:9px 0 9px 0;\ndisplay:inline-block;\nmargin-right:20px;\n}\n.site_name {\n    //font-family: 'Oswald', sans-serif;\n    //font-weight:200  !important;\n    \n    }\n#allstars {\nmargin:0 0 20px 20px;\nfloat:right;\nwidth:300px;\nbackground:#fff600 url('/img/allstars2.png') no-repeat;\npadding:10px;\nborder-radius: 10px;\n}\n#allstars h3 {\npadding:0 50px;\ntext-align:center;\n}\n#allstars li {\nmargin-bottom:10px;\n}\n#main {\npadding:20px;\n}\n\n#nav a.current:link, #nav a.current:visited, #nav a:hover\n{\nborder-bottom: 4px solid #006;\npadding-bottom: 7px;\nbackground: transparent;\ncolor: #000;\n}\n\n.main, #working_space {\npadding:20px;\n}\nh2 {\nfont-size:1.5em;\n}\nh3 {\nfont-size:1.2em;\n}\nh2, h3 {\nfont-weight:bold;\n}\nh2, h3, table {\nmargin-bottom:10px;\n}\n.highlight {\nbackground:yellow;\n}\n</style>\n<script src=\"https://code.jquery.com/jquery-git2.min.js\"></script>\n<script>\n    function numberWithCommas(x) {\n    return x.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n}\n    function cell(value2, value3) {\n        table_html = '';\nif (!(value3 in value2)) {\n        table_html += '<td></td>';\n      } else if (value3.indexOf(\"photo\") > -1) {\n        table_html += '<td class=\"photo\"><img src=\"'+value2[value3]+'\" style=\"max-width:100px\" /></td>';\n      } else if (value2[value3] === parseInt(value2[value3], 10)) {\n        table_html += '<td>'+numberWithCommas(value2[value3])+'</td>';\n      } else if (value3 == 'links') {\n        table_html += '<td><ul>';\n        $.each(value2[value3], function(linki, link) {\n          table_html += '<li><a href=\"'+link['url']+'\">'+link['name']+'</a></li>';\n        });\n        table_html += '</ul></td>';\n      } else if (value3.indexOf('link') > -1) {\n        table_html += '<td><a href=\"'+value2[value3]+'\">'+value2[value3]+'</a></td>';\n      } else if (value3 == 'Summarized results') {\n        var sresults = value2[value3];\n        table_html += '<td><table>';\n        $.each(sresults, function(eindex, employee) {\n          table_html += '<tr><th colspan=\"2\">'+employee['heading']+'</th></tr>';\n          $.each(employee['allegations'], function(aindex, allegation) {\n            table_html += '<tr><th>'+allegation['heading']+'</th><td>'+allegation['allegation']+'</td></tr>';\n            if (stringStartsWith(allegation['opa_finding'], 'Sustained')) {\n              highlighting = ' class=\"highlight\"';\n            } else {\n              highlighting = '';\n            }\n            table_html += '<tr><th>'+allegation['heading']+' OPA finding</th><td'+highlighting+'>'+allegation['opa_finding']+'</td></tr>';\n          });\n          table_html += '<tr><th>Final discipline</th><td>'+employee['final_discipline']+'</td></tr>';\n        });\n        table_html += '</table>';\n        table_html += '</td>';\n      } else if (String(value2[value3]).indexOf('[object Object]') > -1 || Array.isArray(value2[value3])) {\n        if (typeof value2[value3].epoch_time != 'undefined') {\n          var date = new Date(value2[value3].epoch_time*1000);\n          table_html += '<td>'+date+'</td>';\n        } else {\n          table_html += '<td>'+JSON.stringify(value2[value3]).replace(/:\"/g, ': \"').replace(/,/g, ', ')+'</td>';\n        }\n      } else if (value3 in value2) {\n        table_html += '<td>'+value2[value3]+'</td>';\n      }\n        return table_html;\n    }\n    if(typeof console === \"undefined\"){\n    console = { log: function() { } };\n  }\n  function highlight(what, where) {\n    try {  \n    where.each(function() {\n      $(this).html($(this).html().replace(what.not('photo'), '<span class=\"highlight\">'+what+'</span>'));\n    });\n    } catch (err) {\n        \n    }\n  }\nfunction clone(obj) {\n    if (null == obj || \"object\" != typeof obj) return obj;\n    var copy = obj.constructor();\n    for (var attr in obj) {\n        if (obj.hasOwnProperty(attr)) copy[attr] = clone(obj[attr]);\n    }\n    return copy;\n}\nfunction stringStartsWith (string, prefix) {\n  return string.slice(0, prefix.length) == prefix;\n}\nfunction appendLater(what, when) {\n  setTimeout(function() {$('.data_results').append(what)}, when);   \n}\nfunction addData(table, element, data, page) {\n  element.html('');\n  window.payload = data['payload'];\n  //console.log(window.payload);  \n  //console.log('fields '+data['fields']);\n  var additional = '';\n  if ('has_string_in_any_field' in window.payload) {\n    additional = ' mentioning \"'+window.payload['has_string_in_any_field']+'\"';\n    setTimeout(function() {highlight(window.payload['has_string_in_any_field'], $('.data_results td'))}, 1500);\n  }\n  var title = data['table']['name']+additional;\n  var header = '<h2>'+title+'</h2>';\n  element.append(header);\n  header = '';\n  document.title = title + \" | Inside Your Government\";\n  header = '<a href=\"#!/data/?table='+data['table']['id']+'\">Link to table without any subqueries</a> ';\n  header += 'Raw data in JSON format at <span class=\"url\"></span>';\n  header += '<br/><strong>Search:</strong> <input type=\"text\" class=\"search_query\" /><input type=\"button\" data-table=\"'+data['table']['id']+'\" class=\"go\" value=\"go\" />';\n  if (data['number_of_rows'] == 1) {\n    header += ' ('+data['number_of_rows']+' row)';\n  } else {\n    header += ' ('+data['number_of_rows']+' '+data['name_for_rows']+')';\n  }\n  element.append(header);\n  header = '';\n  $.each(data['field_selectors'], function(i, value) {\n    if (value['selector'] == 'checkbox') {\n        var isboth = '';\n        var istrue = '';  \n        var isfalse = '';   \n        if ('filter' in window.payload) {\n          if (value['name'] in window.payload['filter']) {\n\n            switch(window.payload['filter'][value['name']]) {\n              case true:\n                  istrue = ' selected';\n                  break;\n              case false:\n                  isfalse = ' selected';\n                  break;\n            }        \n          }\n          else {\n            isboth = ' selected';\n          }\n        } else {\n          isboth = ' selected';\n        }\n\n        header += ' <select data-field=\"'+value['name']+'\" class=\"boolean_field\"><option value=\"both\"'+isboth+'>Both '+value['display_name']+' and Not '+value['display_name']+'</option><option value=\"true\"'+istrue+'>Only '+value['display_name']+'</option><option value=\"false\"'+isfalse+'>Only Not '+value['display_name']+'</option></select>';\n    } else if (value['selector'] == 'dropdown') {\n        header += ' <strong>'+value['display_name']+'</strong> <select data-field=\"'+value['name']+'\" class=\"dropdown_selector\">';\n        \n        selected = 'none';\n        if ('filter' in window.payload) {\n          if (value['name'] in window.payload['filter']) {\n            selected = window.payload[value['name']];\n          }\n        }\n        $.each(value['items'], function(items_i, item) {\n            if (item == selected) {\n                selected_html = ' selected';\n            } else {\n              selected_html = '';   \n            }\n            header += '<option value=\"'+item+'\"'+selected_html+'>'+item+'</option>';\n        });\n        if (selected == 'none') {\n            if ('none' == selected) {\n              selected_html = ' selected';\n            } else {\n              selected_html = '';   \n            }\n        }\n        header += '<option value=\"none\"'+selected_html+'></option>';\n        header += '</select>';\n    }\n  });\n  header += '<br/><strong>Sorting:</strong> ';\n  header += ' <strong>Field:</strong> ';\n  header += '<select class=\"field_for_sorting\">';\n  header += '<option value=\"\" selected></option>';\n  $.each(data['fields'], function(i, value) {\n    header += '<option value=\"'+value+'\">'+value+'</option>';\n  });\n  header += '</select>';\n  header += ' <strong>Direction:</strong> ';\n  header += '<select class=\"direction_for_sorting\">';\n  header += '<option value=\"desc\" selected>descending</option>';\n  header += '<option value=\"asc\">ascending</option>';   \n  header += '</select>';\n  if ('percentages' in data) {\n    if (data['percentages'].length > 0) {\n      header += '<h3>Auto generated analysis</h3>';\n      header += '<table class=\"data_table percentages\"><tr><th>Field</th><th>Value</th><th>Percentage</th><th>Sentence</th></tr>';\n      \n      $.each(data['percentages'], function(i, value) {\n        new_payload = clone(window.payload);\n        new_payload['filter'] = {};\n        new_payload['filter'][value['field']] = true;\n        header += '<tr><td>'+value['field']+'</td><td><a href=\"/#!/data/?payload='+encodeURIComponent(JSON.stringify(new_payload))+'\">'+value['value']+'</a></td><td>'+value['percentage']+'</td><td>'+value['sentence']+'</tr>';\n      });\n      header += '</table>';\n    }\n  }\n  element.append(header);\n  header = '';\n  header += '<h3>Rankings</h3>';\n  $.each(data['group_counts'], function(j, value2) {\n      header += '<table class=\"data_table\"><tr><th colspan=\"2\">'+value2[0]+'</th></tr>';\n      $.each(value2[1], function(h, value3) {\n          header += '<tr><td>'+JSON.stringify(value3[0])+'</td><td>'+value3[1]+'</td></tr>';\n      });\n      header += '</table>';\n  });\n  header += '<h3>The data</h3>';\n  header += '<div class=\"pages\"></div>';\n  element.append(header);\n  //header = '';\n  \n  var table_html = '<table class=\"data_table data_results\"></table><div class=\"pages\"></div>';\n  element.append(table_html);\n  table_html = '';\n  if (page * per_page < number_of_records) {\n      var rows = data['data'].slice((page-1) * per_page,page * per_page);\n  } else {\n      var rows = data['data'].slice((page-1) * per_page);\n  }\n  $.each(rows, function(j, value2) {\n    table_html += '<tr>';\n    \n    if ('default_fields_to_display' in data['table']) {\n      var fields = data['table']['default_fields_to_display'];\n    } else {\n      var fields = data['fields'];\n    }\n    $.each(fields, function(i, value) {\n      table_html += '<th>'+value+'</th>';\n    });\n    table_html += '</tr>';\n    table_html += '<tr>';\n    $.each(fields, function(h, value3) {\n      table_html += cell(value2, value3); \n    });\n    table_html += '</tr>';\n    //appendLater(table_html, j*5)\n    //$('.data_results').append(table_html);\n    //console.log(table_html);\n  });\n  \n  //table_html += '</table>';\n  setTimeout(function() {$('.data_results').html(table_html);}, 1000);\n    var number_of_records = data['number_of_rows'];\n    var per_page = 10\n    var pages = Math.floor(number_of_records / per_page);\n    if (pages > 1) {\n        if (number_of_records % per_page != 0) {\n            pages += 1;\n        }\n        if (pages+1 < 20) {\n          var end = pages + 1;\n        } else {\n          var end = 20;   \n        }\n        for (var i=1;i<end;i++) {\n            $('.pages').append('<a href=\"\" class=\"to_page_'+i+'\">'+i+'</a>');\n            //console.log(i+' '+pages);\n            if (i != pages) {\n              $('.pages').append(' | ');\n            }\n        }\n    }\n}\nfunction addUrl(element, url) {\n  window.location.hash = '!/data/'+url.substring(45);\n  //console.log('add url '+url);\n  setTimeout(function() {element.find('.url').html('<a href=\"'+url+'\">'+url+'</a>');}, 500);\n}\nfunction getData(table, element, other) {\n  element.text('Loading the data');\n  var params = {'table': table};\n  if (other) {\n    var params = other;\n    params['table'] = table;\n  }\n  $.ajax({\n      url: 'https://api.insideyourgovernment.com/retrive/',\n      data: {'payload': JSON.stringify(params)},\n      dataType: 'json',\n      complete : function(){\n        //console.log('url', this.url);\n          addUrl(element, this.url);\n      },\n      success: function(data){\n        window.data = data;\n        addData(table, element, window.data, 1);\n      }\n  });\n}\nfunction getDataForPayload(payload, element) {\n    element.text('Loading the data');\n  //console.log('type '+String(payload) == '[object Object]');\n  if (String(payload) == '[object Object]') {\n    $.ajax({\n        url: 'https://api.insideyourgovernment.com/retrive/',\n        data: {'payload': JSON.stringify(window.payload)},\n        dataType: 'json',\n        complete : function(){\n          //console.log('url', this.url);\n            addUrl(element, this.url);\n        },\n        success: function(data){\n          var table = data['table'];\n          window.data = data;\n          addData(table, element, data, 1);\n          if ('payload' in data) {\n            if ('has_string_in_any_field' in data['payload']) {\n              setTimeout(function() {$('.search_query').val(data['payload']['has_string_in_any_field'])}, 1000);\n            }\n          }\n        }\n    });\n    \n  } else {\n    \n    $.ajax({\n        url: 'https://api.insideyourgovernment.com/retrive/?payload='+payload,\n        \n        dataType: 'json',\n        complete : function(){\n          //console.log('url', this.url);\n            addUrl(element, this.url);\n        },\n        success: function(data){\n          window.data = data;\n          var table = data['table'];\n          addData(table, element, data, 1);\n          if ('payload' in data) {\n            if ('has_string_in_any_field' in data['payload']) {\n              setTimeout(function() {$('.search_query').val(data['payload']['has_string_in_any_field'])}, 500);\n            }\n          }\n        }\n    });\n  }\n}\nString.prototype.endsWith = function(suffix) {\n  return this.indexOf(suffix, this.length - suffix.length) !== -1;\n};\nfunction processHash() {\n  setTimeout(function() {\n    $('#share_buttons #facebook').html(\"<div class=\\\"fb-share-button\\\" data-href=\\\"\"+window.location+\" data-layout=\\\"button\\\"><\\/div>\");\n    $('#share_buttons #twitter').html(\"<a href=\\\"https:\\/\\/twitter.com\\/share\\\" class=\\\"twitter-share-button\\\"{count} data-size=\\\"large\\\">Tweet<\\/a>\\r\\n<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=\\/^http:\\/.test(d.location)?\\'http\\':\\'https\\';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+\\':\\/\\/platform.twitter.com\\/widgets.js\\';fjs.parentNode.insertBefore(js,fjs);}}(document, \\'script\\', \\'twitter-wjs\\');<\\/script>\");\n  }, 1000);\n  var hash = window.location.hash;\n  if (hash) {\n    if (hash.endsWith('/')) {\n      hash = hash.slice(3,-1);\n    } else {\n      hash = hash.slice(3);         \n    }\n    //console.log(hash);\n    $('.main').hide();\n    $('#nav a').removeClass('current');\n    $(\"[href='/#!/\"+hash+\"/']\").addClass('current');\n    //console.log('substring '+hash.substring(0, 11));\n    $('#working_space').text('');\n    if (hash.substring(0, 9) == 'articles/') {\n        //console.log('next substring '+hash.substring(9));\n        $('#'+hash.substring(9)+'_article').show();\n        document.title = $('#'+hash.substring(9)+'_article h2').text() + ' | Inside Your Government';\n        gaTrack(window.location.hash.substring(2), document.title + ' | Inside Your Government');\n        DISQUS.reset({\n          reload: true,\n          config: function () {  \n            this.page.identifier = hash.substring(9);  \n            this.page.url = window.location;\n          }\n        });\n    } else if (hash.substring(0, 12) == 'data/?table=') {\n        var table = hash.substring(12);\n        //console.log(table);\n        getData(table, $('#working_space'));\n        DISQUS.reset({\n          reload: true,\n          config: function () {  \n            this.page.identifier = hash.substring(9);  \n            this.page.url = window.location;\n          }\n        });\n    } else if (hash.substring(0, 14) == 'data/?payload=') {\n        var payload = hash.substring(14);\n        //console.log(table);\n        getDataForPayload(payload, $('#working_space'));\n        setTimeout(function() {DISQUS.reset({\n          reload: true,\n          config: function () {  \n            this.page.identifier = hash.substring(9);  \n            this.page.url = window.location;\n          }\n        })}, 1000);\n    } else {\n        \n        document.title = $('#'+hash+'_main h2').text() + ' | Inside Your Government';\n        gaTrack(window.location.hash.substring(2), document.title + ' | Inside Your Government');\n        $('#'+hash+'_main').show();\n        \n    }    \n    \n  } else {\n    window.location.hash = '#!/home/';\n    processHash();\n  }\n}\n\nfunction getCookie(cname) {\n    var name = cname + \"=\";\n    var ca = document.cookie.split(';');\n    for(var i=0; i<ca.length; i++) {\n        var c = ca[i];\n        while (c.charAt(0)==' ') c = c.substring(1);\n        if (c.indexOf(name) == 0) return c.substring(name.length,c.length);\n    }\n    return \"\";\n}\n\n// Function to load and initiate the Analytics tracker\nfunction gaTracker(id){\n  $.getScript('//www.google-analytics.com/analytics.js'); // jQuery shortcut\n  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;\n  ga('create', id, 'auto');\n  ga('send', 'pageview');\n}\n\n\n// Function to track a virtual page view\nfunction gaTrack(path, title) {\n  ga('set', { page: path, title: title });\n  ga('send', 'pageview');\n}\n\n\n$(function() {\n  $('#nav').height($('#nav a:link').outerHeight()+2);\n  gaTracker('UA-70789642-1');\n  $('#account_box').hide();\n  $('.main').not('#home').hide();\n  processHash();\n  //$('ul'+hash+':first').show();\n  $('body').on('click', 'a', function() {\n    //console.log($(this).attr('href').substring(0, 1));\n    if ($(this).attr('href').substring(0, 3) == \"/#!\" || $(this).attr('href').substring(0, 2) == \"#!\") {\n      setTimeout(function(){processHash();},100);\n    }\n  });\n  //console.log(document.cookie);\n  //console.log(getCookie('session'));\n  $.get('https://api.insideyourgovernment.com/get_session_info/', {'session': getCookie('session')}, function(data) {\n      //console.log(data);\n      $('#login_box').hide();\n      $('#account_box').show(); \n      if (data['is_admin']) {\n        $('.admin').show();\n        $.get('https://api.insideyourgovernment.com/tables/', function(data) {\n           $.each(data, function(i, value) {\n             $('#tables_for_action').append('<option value=\"'+value+'\">'+value+'</option>');\n           });           \n        });\n      }\n    }); \n  $('#login').click(function() {\n    $.post('https://api.insideyourgovernment.com/login/', {'email': $('#email').val(), 'password': $('#password').val()}, function(data) {\n        //console.log(typeof data);\n        //console.log(data['session_id']);\n      document.cookie=\"session=\"+data['session_id'];\n      //console.log(document.cookie);\n      //console.log(data);  \n    });  \n  });\n  $.fn.getAttributes = function() {\n    var attributes = {}; \n    if( this.length ) {\n        $.each( this[0].attributes, function( index, attr ) {\n            if (attr.name.substring(0,5) == 'data-') {\n              if (attr.name == 'data-pluck') {\n                attributes[ attr.name.slice(5) ] = JSON.parse(attr.value);\n              } else {\n                attributes[ attr.name.slice(5) ] = attr.value;\n              }\n            } else {\n              attributes[ attr.name ] = attr.value;\n            }\n        } ); \n    }\n    return attributes;\n  };\n  function addDivsOfTables(theObj, data) {\n    //theObj.html(JSON.stringify(data));\n    $.each(data['keys'], function(i, value) {\n      var table = '<table class=\"data_table\">';\n      table += '<tr><th>Link</th>';\n      $.each(data['table_fields'], function(j, value2) {\n        table += '<th>'+value2+'</th>';\n      });\n      //console.log(value+' '+JSON.stringify(data[value]));\n      $.each(data['data'][value], function(j, value2) {\n        table += '<tr>';\n        table += '<td><a href=\"/#!/data/?table='+value2[theObj.attr('data-field_for_url')]+'\">'+value2[theObj.attr('data-field_to_name_link')]+'</a>';\n        $.each(data['table_fields'], function(h, value3) {\n          table += cell(value2, value3);\n        });\n        table += '</tr>';\n      });\n      table += '</tr>';\n      table += '</table>';\n      theObj.append('<div class=\"box_200\"><h3>'+value+'</h3>'+table+'</div>');\n    });\n  }\n  function getDivsOfTables(theObj) {\n    var params = theObj.getAttributes();\n    //console.log('https://api.insideyourgovernment.com/retrive/?payload='+encodeURIComponent(JSON.stringify(params)))\n    $.get('https://api.insideyourgovernment.com/retrive/', {'payload': JSON.stringify(params)}, function(data) {\n      //console.log(data);\n        \n      addDivsOfTables(theObj, data);\n    });\n  }\n  $('.divs_of_tables').each(function() {\n    getDivsOfTables($(this));\n  });\n\n  $('body').on('click', '.go', function() {\n    var query = $(this).prev().val();\n    getData($(this).attr('data-table'), $('#working_space'), {'has_string_in_any_field': query});\n    setTimeout(function() {$('.search_query').val(query)}, 1000);\n    setTimeout(function() {highlight($('.search_query').val(), $('#working_space td').not('.photo'))}, 1000);\n  });\n  $(\"body\").on('keyup', '.search_query', function (e) {\n    if (e.keyCode == 13) {\n        $(this).parent().find('.go').trigger('click');\n    }\n  });\n  $('body').on('change', '.boolean_field', function(e) {\n    var f = $(this).attr('data-field');\n    window.payload['filter'] = {};\n    //console.log(JSON.stringify(window.payload));\n    if ($(this).val() == 'both') {\n      if ('filter' in window.payload) {\n        if ($(this).attr('data-field') in window.payload['filter']) {\n          delete window.payload['filter'][$(this).attr('data-field')];\n        }\n        if (Object.keys(window.payload['filter'])) {\n          delete window.payload['filter'];\n        }\n      }      \n    } else {\n      //console.log($(this).val(), Boolean($(this).val()));\n      window.payload['filter'][f] = ($(this).val() == 'true');\n    }\n    getDataForPayload(window.payload, $('#working_space'));\n    \n  });\n  $('body').on('change', '.dropdown_selector', function(e) {\n    var f = $(this).attr('data-field');\n    window.payload['filter'] = {};\n    //console.log(JSON.stringify(window.payload));\n    if ($(this).val() == 'none') {\n      if ('filter' in window.payload) {\n        if ($(this).attr('data-field') in window.payload['filter']) {\n          delete window.payload['filter'][$(this).attr('data-field')];\n        }\n        //if (Object.keys(window.payload['filter'])) {\n        //  delete window.payload['filter'];\n        //}\n      }      \n    } else {\n      //console.log($(this).val(), Boolean($(this).val()));\n      window.payload['filter'][f] = $(this).val();\n    }\n    getDataForPayload(window.payload, $('#working_space'));\n    \n  }); \n   $('body').on('click', '.pages a', function(e) {\n        e.preventDefault();\n        $('.pages a').removeClass('current');\n        $('.to_page_'+$(this).text()).addClass('current');\n        window['page'] = parseInt($(this).text());\n        getDataForPayload(window.data, $('#working_space'));\n        //addData(window.data['table']['id'], $('#working_space'), window.data, $(this).text());\n   });\n});\n</script>\n</head>\n<body>\n    <!--\n<a href=\"/#!/home/\" id=\"header\">\n<h1>Inside Your Government</h1>\n\n\n</a>\n    \n<div id=\"intro\">\n<strong>The mission:</strong> To make government transparent by default and to do as much <strong style=\"font-style:italic\">good</strong> with that transparency as possible.<br/>\n    <strong>Email:</strong> <a href=\"mailto:info@insideyourgovernment.com\">info@insideyourgovernment.com</a>\n    <strong>Twitter:</strong> <a href=\"https://twitter.com/insideyourgov\">@insideyourgov</a>\n    <strong>Facebook:</strong> <a href=\"https://www.facebook.com/insideyourgovernment/\">https://www.facebook.com/insideyourgovernment/</a>\n    <strong>Phone:</strong> (701) 404-7468\n\n</div>\n-->\n<ul id=\"nav\">\n    <li><a href=\"\" class=\"site_name\">Inside Your Government</a></li>\n    <!--\n<li><a href=\"/#!/about/\" data-id=\"about\">About Inside Your Government</a></li>-->\n<li><a href=\"/#!/data/\" data-id=\"data\">Open Data</a></li>\n\n<!--<li><a href=\"/#!/news/\" data-id=\"News\">News</a></li>\n<li><a href=\"/#!/get_involved/\" data-id=\"get_involved\">Get Involved</a></li>-->\n</ul>\n<p style=\"margin:20px 20px 0 20px;\"><strong>Attention:</strong> Inside Your Government (IYG) is a new web site aiming to be the most comprehensive free online source of news, searchable data, and apps about governments world wide. This site is in the early stages of being developed. Contact Tim Clemans at <a href=\"mailto:tim@insideyourgovernment.com\">tim@insideyourgovernment.com</a> for more information. Development activity log is at <a href=\"https://docs.google.com/spreadsheets/d/1qYpbFjDn3bmTEPjIlqaBEmduUea0-PLSBgQy9HqEsFw/edit#gid=0&vpid=A1\">https://docs.google.com/spreadsheets/d/1qYpbFjDn3bmTEPjIlqaBEmduUea0-PLSBgQy9HqEsFw/edit#gid=0&vpid=A1</a> The development focus is on the importing of data. The site is open source and its code is at <a href=\"https://github.com/insideyourgovernment/\">https://github.com/insideyourgovernment/</a></p>\n<div id=\"home_main\" class=\"main\">\n\n<div id=\"allstars\">\n<h3>Government Transparency All Stars</h3>\n<ul>\n<li><strong>New York City:</strong> By local law each city entity is to publish all of its digital public data by 2018. </li>\n<li><strong>Seattle Police Department:</strong> Posted on Youtube dash camera videos of three officer-involved shootings on the same day of the shootings.</li>\n\n<li><strong>King County Sheriff's Office:</strong> Released a spreadsheet of over 12 thousand employee actions including alleged misconduct with names in just 11 calendar days.</li>\n<li><strong>City of Redmond:</strong> Publishes money spent.</li>\n\n</ul>\n</div><h2>Home</h2>\n</div>\n<div class=\"main\" id=\"about_main\"><h2>About Inside Your Government</h2></div>\n<div class=\"main\" id=\"data_main\"><h2>Open Data</h2>\n\n<div id=\"data_admin\" class=\"admin\"><strong>Action:</strong> \n<select id=\"data_admin_action\">\n<option></option>\n<option value=\"table_create\">Table create</option>\n<option value=\"insert\">Insert</option>\n<option value=\"update\">Update</option>\n</select>\n<strong>Table name:</strong> <input type=\"text\" id=\"table_name_for_action\" /> \n<strong>Table:</strong> <select id=\"tables_for_action\">\n<option></option>\n</select>\n<strong>Dictionary:</strong> <input type=\"text\" id=\"dictionary_for_action\" />\n<input type=\"button\" value=\"Run\" />\n</div>\n\n<div class=\"divs_of_tables\" data-action=\"do_row_mapping\" data-table=\"tables\" data-field_for_key=\"categories\" data-field_for_url=\"id\" data-field_to_name_link=\"name\" data-rows_per_page=\"500\"></div>\n\n</div>\n<div class=\"main\" id=\"news_main\"><h2>News</h2></div>\n<div class=\"main\" id=\"get_involved_main\"><h2>Get Involved</h2></div>\n<div id=\"working_space\"></div>\n<script>\n/**\n* RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.\n* LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables\n*/\n/*\nvar disqus_config = function () {\nthis.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable\nthis.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable\n};\n*/\n(function() { // DON'T EDIT BELOW THIS LINE\nvar d = document, s = d.createElement('script');\n\ns.src = 'https://insideyourgovernment.disqus.com/embed.js';\n\ns.setAttribute('data-timestamp', +new Date());\n(d.head || d.body).appendChild(s);\n})();\n</script>\n<noscript>Please enable JavaScript to view the <a href=\"https://disqus.com/?ref_noscript\" rel=\"nofollow\">comments powered by Disqus.</a></noscript> \n<div id=\"disqus_thread\" style=\"width:50%; margin:10px 20px;\"></div>\n</div>\n</body>\n</html>\n"]],0,0,1,29975]],"time":1450809542225}